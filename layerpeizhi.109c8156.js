import{T as E}from"./index.75b94a68.js";import{g as N,a as U,b as x}from"./table.b6bd7b42.js";import{g as _,d as R,b as z}from"./codeeditapi.b7d522e7.js";import{r as I,s as q}from"./enum.8cbae253.js";import{d as V,L as j,k as m,j as w,_ as M,E as T,r as g,G as O,o as B,z as A,w as C,b as a,a as L,H}from"./index.2d078062.js";const J=V({data(){return{myData:[],myDatav:[],table:[],tableDatak:[],resultArray:[]}},components:{Table:E,Layer:j},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},created(){({page:this.page.index,pageSize:this.page.size,...this.query},this.getProductv())},setup(e,o){const s=(l,D)=>{let i={roadPoolCode:l.map(d=>d.RoadUid).join(","),uidcode:D};R(i).then(d=>{T({type:"success",message:"\u901A\u9053\u914D\u7F6E\u6210\u529F"}),b(c.value.length===1),h&&h.close()})},u=m(!0),c=m([]);let F=m([]);const f=m([]),t=m(null),h=m(null);let y=m({Userid:"",RoadUid:"",RoadName:"",RoadRemark:"",ProductName:"",PayType:"",BasicRate:"",SettleFee:"",RoadTotalLimit:"",RoadEverydayLimit:"",SingleMinLimit:"",SingleMaxLimit:"",StartHour:"0",EndHour:"23",Params:"",roadPoolCode:"",uidcode:""});const v=(l,D)=>{let i=y.value.RoadPoolCode;z(l,i).then(d=>{console.log("Response:",d),T({type:"success",message:"\u901A\u9053\u914D\u7F6E\u6210\u529F"})}).catch(d=>{console.error("Error:",d)})},S=l=>{n.size=l,b(!0)},P=l=>{n.index=l,b(!1)},r=l=>{f.value=l},p=w({input:"",startTime:"",endTime:"",supplierUid:"",payWayCode:"",merchantName:"",agentName:"",bankOrderId:"",orderStatus:"",roadPoolCode:""}),b=l=>{u.value=!0,l&&(n.index=1);let D={page:n.index,pageSize:n.size,...p};_(D).then(i=>{const d=i.RoadInfoList;c.value=d,n.total=Number(i.TotalPage)*n.size}).catch(i=>{console.error("\u83B7\u53D6\u6570\u636E\u5931\u8D25:",i),c.value=[],n.index=1,n.total=0}).finally(()=>{u.value=!1})},n=w({index:1,size:20,total:0}),$={roadUid:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}]};k();function k(){e.layer.row&&(p.roadPoolCode=e.layer.row.RoadPoolCode,y.value=JSON.parse(JSON.stringify(e.layer.row)))}return b(!0),{form:y,rules:$,layerDom:h,ruleForm:t,radioData:I,page:n,loading:u,tableData:c,getTableData:b,Table:E,getDatalunxun:_,handleCheckboxChange:v,handleSelectionChange:r,query:p,myDatav:F,handleDel:s,chooseData:f,deltongdao:R,getDatalunxunon:z,selectData:q,handleSizeChange:S,handleCurrentChange:P}},methods:{submit(e,o){this.layerDom&&this.layerDom.close()},getProductv(){N().then(e=>{this.myData=e.ProductMap})},getProductone(e){_(e).then(o=>{this.myDatav=o.RoadPool.RoadUidPool,this.resultArray=this.myDatav.split("||"),this.resultArray.forEach(s=>{this.tableData.forEach((u,c)=>{s===u.RoadUid&&this.$refs.table.toggleRowSelection(this.tableData[c],!0)})})})},addForm(e){U(e).then(o=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){x(e).then(o=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}},watch:{active:{handler(e,o){this.$nextTick(()=>{e=="6"?this.table.forEach((s,u)=>{s.type=="1"&&this.$refs.table.toggleRowSelection(this.tableData[1],!0)}):e=="7"&&this.table.forEach((s,u)=>{s.type=="1"&&this.$refs.table.toggleRowSelection(this.tableData[1],!0)})})},immediate:!0,deep:!0}}}),G={class:"layout-container-table"},W={class:"pagination-container"};function K(e,o,s,u,c,F){const f=g("el-checkbox"),t=g("el-table-column"),h=g("el-table"),y=g("el-pagination"),v=g("el-form"),S=g("Layer"),P=O("loading");return B(),A(S,{layer:e.layer,onConfirm:o[2]||(o[2]=r=>e.submit(e.chooseData,e.query.roadPoolCode)),ref:"layerDom"},{default:C(()=>[a(v,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"180px",style:{"margin-right":"3px"}},{default:C(()=>[L("div",G,[H((B(),A(h,{ref:"table",data:e.tableData,onSelectionChange:e.handleSelectionChange},{default:C(()=>[a(t,{type:"selection",align:"center",label:"\u9009\u62E9",width:"45"},{default:C(r=>[a(f,{modelValue:r.row.Starttrue,"onUpdate:modelValue":p=>r.row.Starttrue=p,onInput:p=>e.handleCheckboxChange(r.row,p)},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1}),a(t,{prop:"RoadName",label:"\u901A\u9053\u540D\u79F0",align:"center",width:"120"}),a(t,{prop:"ProductName",label:"\u4EA7\u54C1\u540D\u79F0",align:"center"}),a(t,{prop:"PayType",label:"\u652F\u4ED8\u7C7B\u578B",align:"center"}),a(t,{prop:"BasicFee",label:"\u6210\u672C\u6C47\u7387",align:"center"}),a(t,{prop:"Starttrue",label:"\u72B6\u6001",align:"center"}),a(t,{prop:"TotalLimit",label:"\u901A\u9053\u603B\u989D\u5EA6",align:"center","class-name":"hide-column-content"}),a(t,{prop:"TodayLimit",label:"\u6BCF\u5929\u9650\u989D",align:"center","class-name":"hide-column-content"}),a(t,{prop:"TodayIncome",label:"\u603B\u6D41\u6C34",align:"center"}),a(t,{prop:"TotalIncome",label:"\u4ECA\u65E5\u6D41\u6C34",align:"center"}),a(t,{prop:"TotalProfit",label:"\u603B\u5229\u6DA6",align:"center"}),a(t,{prop:"TodayProfit",label:"\u4ECA\u65E5\u5229\u6DA6",align:"center"}),a(t,{prop:"RequestSuccess",label:"\u6210\u529F\u6570",align:"center"}),a(t,{prop:"RequestAll",label:"\u8BF7\u6C42\u6570",align:"center"})]),_:1},8,["data","onSelectionChange"])),[[P,e.loading]])]),L("div",W,[a(y,{currentPage:e.page.index,"onUpdate:currentPage":o[0]||(o[0]=r=>e.page.index=r),pageSize:e.page.size,"onUpdate:pageSize":o[1]||(o[1]=r=>e.page.size=r),total:e.page.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:e.handleSizeChange,onCurrentChange:e.handleCurrentChange},null,8,["currentPage","pageSize","total","onSizeChange","onCurrentChange"])])]),_:1},8,["model","rules"])]),_:1},8,["layer"])}var ae=M(J,[["render",K],["__scopeId","data-v-767691c6"]]);export{ae as L};
