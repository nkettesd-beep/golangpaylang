import{T as L}from"./index.75b94a68.js";import{v as B,d as R,L as E,k as b,_,r as s,o as g,z as D,w as l,b as t,j as v,G as S,c as N,a as $,e as y,t as C,H as P,I as T,E as V}from"./index.2d078062.js";import{m as A,b as G}from"./table.b6bd7b42.js";import{r as q,s as z}from"./enum.8cbae253.js";import{L as U}from"./layerpeizhi.109c8156.js";import{P as I,S as j,D as O}from"./Search.b2bfb72f.js";import"./codeeditapi.b7d522e7.js";function J(e){return B({url:"/get/roadPool",method:"GET",data:e})}function H(e){return B({url:"/delete/roadPool?roadPoolCode="+e.roadPoolCode,method:"GET",data:e})}const M=R({data(){return{myData:[],myDatav:[]}},components:{Layer:E},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const d=b(null),r=b(null);let m=b({RoadName:"",RoadRemark:""});const p={RoadName:[{required:!0,message:"\u8BF7\u8F93\u901A\u9053\u6C60\u540D\u79F0",trigger:"blur"}],RoadRemark:[{required:!0,message:"\u8BF7\u8F93\u5165\u901A\u9053\u6C60\u7F16\u53F7",trigger:"blur"}]};n();function n(){e.layer.row&&(m.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:m,rules:p,layerDom:r,ruleForm:d,radioData:q,selectData:z}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){A(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){G(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function K(e,a,d,r,m,p){const n=s("el-input"),c=s("el-form-item"),f=s("el-form"),u=s("Layer");return g(),D(u,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:l(()=>[t(f,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:l(()=>[t(c,{label:"\u901A\u9053\u6C60\u540D\u79F0\uFF1A",prop:"RoadName"},{default:l(()=>[t(n,{modelValue:e.form.RoadName,"onUpdate:modelValue":a[0]||(a[0]=h=>e.form.RoadName=h),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(c,{label:"\u901A\u9053\u6C60\u7F16\u53F7\uFF1A",prop:"RoadRemark"},{default:l(()=>[t(n,{modelValue:e.form.RoadRemark,"onUpdate:modelValue":a[1]||(a[1]=h=>e.form.RoadRemark=h),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var Q=_(M,[["render",K]]);const W=R({name:"crudTable",components:{Table:L,Layeredit:U,Layer:Q},setup(){const e=v({input:""}),a=v({show:!1,title:"\u65B0\u589E",showButton:!0}),d=v({show:!1,title:"\u914D\u7F6E",showButton:!0}),r=v({index:1,size:20,total:0}),m=b(!0),p=b([]),n=b([]),c=i=>{n.value=i},f=i=>{m.value=!0,i&&(r.index=1);let F={page:r.index,pageSize:r.size,...e};J(F).then(o=>{o.RoadPoolInfoList,p.value=o.RoadPoolInfoList,r.total=Number(o.DisplayCount)}).catch(o=>{p.value=[],r.index=1,r.total=0}).finally(()=>{m.value=!1})},u=i=>{let F={roadPoolCode:i.map(o=>o.RoadPoolCode).join(",")};H(F).then(o=>{V({type:"success",message:"\u5220\u9664\u6210\u529F22"}),f(p.value.length===1)})},h=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},w=i=>{d.title="\u7F16\u8F91\u6570\u636E",d.row=i,d.show=!0};return f(!0),{Plus:I,Search:j,Delete:O,query:e,tableData:p,chooseData:n,loading:m,page:r,layer:a,Layeredit:d,handleSelectionChange:c,handleAdd:h,handleEdit:w,handleDel:u,getTableData:f}}}),X={class:"layout-container"},Y={class:"layout-container-form flex space-between"},Z={class:"layout-container-form-handle"},x={class:"layout-container-form-search"},ee={class:"layout-container-table"};function ae(e,a,d,r,m,p){const n=s("el-button"),c=s("el-popconfirm"),f=s("el-input"),u=s("el-table-column"),h=s("Table"),w=s("Layer"),i=s("Layeredit"),F=S("loading");return g(),N("div",X,[$("div",Y,[$("div",Z,[t(n,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:l(()=>[y(C(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),t(c,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=o=>e.handleDel(e.chooseData))},{reference:l(()=>[t(n,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:l(()=>[y(C(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),$("div",x,[t(f,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=o=>e.query.input=o),placeholder:e.$t("message.common.searchTip"),onChange:a[2]||(a[2]=o=>e.getTableData(!0))},null,8,["modelValue","placeholder"]),t(n,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[3]||(a[3]=o=>e.getTableData(!0))},{default:l(()=>[y(C(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),$("div",ee,[P((g(),D(h,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=o=>e.page=o),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:l(()=>[t(u,{prop:"RoadPoolName",label:"\u901A\u9053\u6C60\u540D\u79F0",align:"center"}),t(u,{prop:"RoadPoolCode",label:"\u901A\u9053\u6C60\u7F16\u53F7",align:"center"}),t(u,{prop:"Status",label:"\u72B6\u6001",align:"center"},{default:l(o=>[o.row.Status=="active"?(g(),D(n,{key:0},{default:l(()=>[y(" \u6FC0\u6D3B ")]),_:1})):(g(),D(n,{key:1,type:"primary"},{default:l(()=>[y(" \u51BB\u7ED3 ")]),_:1}))]),_:1}),t(u,{prop:"UpdateTime",label:"\u66F4\u65B0\u65F6\u95F4",align:"center"}),t(u,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:l(o=>[t(n,{onClick:k=>e.handleEdit(o.row)},{default:l(()=>[y(C(e.$t("message.common.peizhi")),1)]),_:2},1032,["onClick"]),t(c,{title:e.$t("message.common.delTip"),onConfirm:k=>e.handleDel([o.row])},{reference:l(()=>[t(n,{type:"danger"},{default:l(()=>[y(C(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[F,e.loading]]),e.layer.show?(g(),D(w,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):T("",!0),e.Layeredit.show?(g(),D(i,{key:1,layer:e.Layeredit,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):T("",!0)])])}var ie=_(W,[["render",ae]]);export{ie as default};
