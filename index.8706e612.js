import{g as k,d as N,u as S}from"./user.e7725fd5.js";import{T as V}from"./index.75b94a68.js";import{d as B,L,j as D,_ as w,r as u,o as v,z as C,w as s,b as t,H as E,a as h,N as A,k as $,G as U,c as q,e as y,t as F,I as j,E as T}from"./index.2d078062.js";import{o as G,b as I}from"./table.b6bd7b42.js";import{P as z,D as P,S as M}from"./Search.b2bfb72f.js";const H=B({components:{Layer:L},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){return{ruleForm:D({RoleName:"",Remark:""}),rules:{RoleName:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],select:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}],radio:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}]},options:[{value:1,label:"\u8FD0\u52A8"},{value:2,label:"\u5065\u8EAB"},{value:3,label:"\u8DD1\u9177"},{value:4,label:"\u8857\u821E"}]}},methods:{submit(){this.$refs.form.validate(e=>{if(e){let a=this.ruleForm;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){G(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.layer.show=!1,this.$emit("getTableData",!0)})},updateForm(e){I(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1)})}}});function O(e,a,n,g,p,b){const d=u("el-input"),i=u("el-form-item"),f=u("el-form"),r=u("Layer",!0);return v(),C(r,{layer:e.layer,onConfirm:e.submit},{default:s(()=>[t(f,{model:e.ruleForm,rules:e.rules,ref:"form","label-width":"120px",style:{"margin-right":"30px"}},{default:s(()=>[t(i,{label:"\u89D2\u8272\u540D\u79F0\uFF1A",prop:"RoleName"},{default:s(()=>[t(d,{modelValue:e.ruleForm.RoleName,"onUpdate:modelValue":a[0]||(a[0]=c=>e.ruleForm.RoleName=c),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(i,{label:"\u89D2\u8272\u63CF\u8FF0\uFF1A",prop:"Remark"},{default:s(()=>[E(h("textarea",{"onUpdate:modelValue":a[1]||(a[1]=c=>e.ruleForm.Remark=c)},null,512),[[A,e.ruleForm.Remark]])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var J=w(H,[["render",O]]);const K=B({components:{Table:V,Layer:J},setup(){const e=D({input:""}),a=D({show:!1,title:"\u65B0\u589E",showButton:!0}),n=D({index:1,size:20,total:0}),g=$(!0),p=$([]),b=$([]),d=o=>{b.value=o},i=o=>{g.value=!0,o&&(n.index=1),{page:n.index,pageSize:n.size,...e},k().then(l=>{let m=l.RoleInfoList;m.forEach(R=>{R.loading=!1}),p.value=m,n.total=Number(l.TotalPage)}).catch(l=>{p.value=[],n.index=1,n.total=0}).finally(()=>{g.value=!1})},f=o=>{let l={ids:o.map(m=>m.RoleUid).join(",")};N(l).then(m=>{T({type:"success",message:"\u5220\u9664\u6210\u529F"}),i(p.value.length===1)})},r=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},c=o=>{a.title="\u7F16\u8F91\u6570\u636E",a.row=o,a.show=!0},_=o=>{if(!o.id)return;o.loading=!0;let l={id:o.id,status:o.status};S(l).then(m=>{T({type:"success",message:"\u72B6\u6001\u53D8\u66F4\u6210\u529F"})}).catch(m=>{T({type:"error",message:"\u72B6\u6001\u53D8\u66F4\u5931\u8D25"})}).finally(()=>{o.loading=!1})};return i(!0),{Plus:z,Delete:P,Search:M,query:e,tableData:p,chooseData:b,loading:g,page:n,layer:a,handleSelectionChange:d,getTableData:i,handleDel:f,handleAdd:r,handleEdit:c,handleUpdateStatus:_}}}),Q={class:"layout-container"},W={class:"layout-container-form flex space-between"},X={class:"layout-container-form-handle"},Y={class:"layout-container-form-search"},Z={class:"layout-container-table"};function x(e,a,n,g,p,b){const d=u("el-button"),i=u("el-popconfirm"),f=u("el-input"),r=u("el-table-column"),c=u("Table"),_=u("Layer"),o=U("loading");return v(),q("div",Q,[h("div",W,[h("div",X,[t(d,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:s(()=>[y(F(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),t(i,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=l=>e.handleDel(e.chooseData))},{reference:s(()=>[t(d,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:s(()=>[y(F(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),h("div",Y,[t(f,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=l=>e.query.input=l),placeholder:e.$t("message.common.searchTip")},null,8,["modelValue","placeholder"]),t(d,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[2]||(a[2]=l=>e.getTableData(!0))},{default:s(()=>[y(F(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),h("div",Z,[E((v(),C(c,{ref:"table",page:e.page,"onUpdate:page":a[3]||(a[3]=l=>e.page=l),showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:s(()=>[t(r,{prop:"Id",label:"Id",align:"center",width:"80"}),t(r,{prop:"RoleName",label:"\u89D2\u8272\u540D\u79F0",align:"center"}),t(r,{prop:"RoleUid",label:"\u89D2\u8272\u6807\u8BC6\u53F7",align:"center"}),t(r,{prop:"Remark",label:"\u5907\u6CE8",align:"center"}),t(r,{prop:"CreateTime",label:"\u521B\u5EFA\u65F6\u95F4",align:"center"}),t(r,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:s(l=>[t(i,{title:e.$t("message.common.delTip"),onConfirm:m=>e.handleDel([l.row])},{reference:s(()=>[t(d,{type:"danger"},{default:s(()=>[y(F(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[o,e.loading]]),e.layer.show?(v(),C(_,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):j("",!0)])])}var se=w(K,[["render",x],["__scopeId","data-v-f336b56c"]]);export{se as default};
