import{T as L}from"./index.75b94a68.js";import{b as E,u as k,c as N,e as S}from"./tablepro.50b12198.js";import{r as R,s as V}from"./enum.8cbae253.js";import{d as _,L as A,k as h,_ as B,r as s,o as b,z as C,w as r,b as o,j as D,G,c as q,a as v,e as F,t as $,H as z,I as T,E as P}from"./index.2d078062.js";import{L as j}from"./layerpeizhi.109c8156.js";import{P as I,S as O,D as U}from"./Search.b2bfb72f.js";import"./table.b6bd7b42.js";import"./codeeditapi.b7d522e7.js";const J=_({data(){return{myData:[],myDatav:[]}},components:{Layer:A},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const i=h(null),l=h(null);let m=h({RoadName:"",RoadRemark:""});const d={RoadName:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0",trigger:"blur"}]};n();function n(){e.layer.row&&(m.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:m,rules:d,layerDom:l,ruleForm:i,radioData:R,selectData:V}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){E(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){k(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function H(e,a,i,l,m,d){const n=s("el-input"),f=s("el-form-item"),p=s("el-form"),c=s("Layer");return b(),C(c,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:r(()=>[o(p,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:r(()=>[o(f,{label:"\u4EA7\u54C1\u7C7B\u578B\u540D\u79F0\uFF1A",prop:"RoadName"},{default:r(()=>[o(n,{modelValue:e.form.RoadName,"onUpdate:modelValue":a[0]||(a[0]=y=>e.form.RoadName=y),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var M=B(J,[["render",H]]);const K=_({name:"crudTable",components:{Table:L,Layeredit:j,Layer:M},setup(){const e=D({input:""}),a=D({show:!1,title:"\u65B0\u589E",showButton:!0}),i=D({show:!1,title:"\u914D\u7F6E",showButton:!0}),l=D({index:1,size:20,total:0}),m=h(!0),d=h([]),n=h([]),f=u=>{n.value=u},p=u=>{m.value=!0,u&&(l.index=1);let g={page:l.index,pageSize:l.size,...e};N(g).then(t=>{t.Roadbank,d.value=t.Roadbank,l.total=Number(t.DisplayCount)}).catch(t=>{d.value=[],l.index=1,l.total=0}).finally(()=>{m.value=!1})},c=u=>{let g={roadPoolCode:u.map(t=>t.Id).join(",")};S(g).then(t=>{P({type:"success",message:"\u5220\u9664\u6210\u529F"}),p(d.value.length===1)})},y=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},w=u=>{i.title="\u7F16\u8F91\u6570\u636E",i.row=u,i.show=!0};return p(!0),{Plus:I,Search:O,Delete:U,query:e,tableData:d,chooseData:n,loading:m,page:l,layer:a,Layeredit:i,handleSelectionChange:f,handleAdd:y,handleEdit:w,handleDel:c,getTableData:p}}}),Q={class:"layout-container"},W={class:"layout-container-form flex space-between"},X={class:"layout-container-form-handle"},Y={class:"layout-container-form-search"},Z={class:"layout-container-table"};function x(e,a,i,l,m,d){const n=s("el-button"),f=s("el-popconfirm"),p=s("el-input"),c=s("el-table-column"),y=s("Table"),w=s("Layer"),u=s("Layeredit"),g=G("loading");return b(),q("div",Q,[v("div",W,[v("div",X,[o(n,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:r(()=>[F($(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),o(f,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=t=>e.handleDel(e.chooseData))},{reference:r(()=>[o(n,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:r(()=>[F($(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),v("div",Y,[o(p,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=t=>e.query.input=t),placeholder:e.$t("message.common.searchTip"),onChange:a[2]||(a[2]=t=>e.getTableData(!0))},null,8,["modelValue","placeholder"]),o(n,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[3]||(a[3]=t=>e.getTableData(!0))},{default:r(()=>[F($(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),v("div",Z,[z((b(),C(y,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=t=>e.page=t),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:r(()=>[o(c,{prop:"Name",label:"\u5206\u7C7B\u4EA7\u54C1\u540D\u79F0",align:"center"}),o(c,{prop:"RoldRang",label:"\u5206\u7C7B\u4EA7\u54C1\u7F16\u7801",align:"center"}),o(c,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:r(t=>[o(f,{title:e.$t("message.common.delTip"),onConfirm:ee=>e.handleDel([t.row])},{reference:r(()=>[o(n,{type:"danger"},{default:r(()=>[F($(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[g,e.loading]]),e.layer.show?(b(),C(w,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):T("",!0),e.Layeredit.show?(b(),C(u,{key:1,layer:e.Layeredit,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):T("",!0)])])}var ie=B(K,[["render",x]]);export{ie as default};
