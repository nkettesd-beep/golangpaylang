import{T as _}from"./index.75b94a68.js";import{a as k,u as L,g as B,d as N}from"./tablepro.50b12198.js";import{r as A,s as S}from"./enum.8cbae253.js";import{d as E,L as V,k as h,_ as R,r as s,o as D,z as v,w as n,b as o,j as b,G,c as q,a as F,e as C,t as $,H as z,I as T,E as P}from"./index.2d078062.js";import{L as U}from"./layerpeizhi.109c8156.js";import{P as j,S as I,D as O}from"./Search.b2bfb72f.js";import"./table.b6bd7b42.js";import"./codeeditapi.b7d522e7.js";const J=E({data(){return{myData:[],myDatav:[]}},components:{Layer:V},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const i=h(null),r=h(null);let m=h({RoadName:"",RoadRemark:""});const d={RoadName:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u540D\u79F0",trigger:"blur"}],RoadRemark:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u7F16\u53F7\u6216\u4EE3\u7801_SCAN\u7ED3\u5C3E",trigger:"blur"}]};l();function l(){e.layer.row&&(m.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:m,rules:d,layerDom:r,ruleForm:i,radioData:A,selectData:S}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){k(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){L(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function H(e,a,i,r,m,d){const l=s("el-input"),p=s("el-form-item"),c=s("el-form"),f=s("Layer");return D(),v(f,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:n(()=>[o(c,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:n(()=>[o(p,{label:"\u4EA7\u54C1\u540D\u79F0\uFF1A",prop:"RoadName"},{default:n(()=>[o(l,{modelValue:e.form.RoadName,"onUpdate:modelValue":a[0]||(a[0]=g=>e.form.RoadName=g),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(p,{label:"\u4EA7\u54C1\u7F16\u53F7_SCAN\u7ED3\u5C3E\uFF1A",prop:"RoadRemark"},{default:n(()=>[o(l,{modelValue:e.form.RoadRemark,"onUpdate:modelValue":a[1]||(a[1]=g=>e.form.RoadRemark=g),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var M=R(J,[["render",H]]);const K=E({name:"crudTable",components:{Table:_,Layeredit:U,Layer:M},setup(){const e=b({input:""}),a=b({show:!1,title:"\u65B0\u589E",showButton:!0}),i=b({show:!1,title:"\u914D\u7F6E",showButton:!0}),r=b({index:1,size:20,total:0}),m=h(!0),d=h([]),l=h([]),p=u=>{l.value=u},c=u=>{m.value=!0,u&&(r.index=1);let y={page:r.index,pageSize:r.size,...e};B(y).then(t=>{t.Roadbank,d.value=t.Roadbank,r.total=Number(t.DisplayCount)}).catch(t=>{d.value=[],r.index=1,r.total=0}).finally(()=>{m.value=!1})},f=u=>{let y={roadPoolCode:u.map(t=>t.Id).join(",")};N(y).then(t=>{P({type:"success",message:"\u5220\u9664\u6210\u529F"}),c(d.value.length===1)})},g=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},w=u=>{i.title="\u7F16\u8F91\u6570\u636E",i.row=u,i.show=!0};return c(!0),{Plus:j,Search:I,Delete:O,query:e,tableData:d,chooseData:l,loading:m,page:r,layer:a,Layeredit:i,handleSelectionChange:p,handleAdd:g,handleEdit:w,handleDel:f,getTableData:c}}}),Q={class:"layout-container"},W={class:"layout-container-form flex space-between"},X={class:"layout-container-form-handle"},Y={class:"layout-container-form-search"},Z={class:"layout-container-table"};function x(e,a,i,r,m,d){const l=s("el-button"),p=s("el-popconfirm"),c=s("el-input"),f=s("el-table-column"),g=s("Table"),w=s("Layer"),u=s("Layeredit"),y=G("loading");return D(),q("div",Q,[F("div",W,[F("div",X,[o(l,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:n(()=>[C($(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),o(p,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=t=>e.handleDel(e.chooseData))},{reference:n(()=>[o(l,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:n(()=>[C($(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),F("div",Y,[o(c,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=t=>e.query.input=t),placeholder:e.$t("message.common.searchTip"),onChange:a[2]||(a[2]=t=>e.getTableData(!0))},null,8,["modelValue","placeholder"]),o(l,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[3]||(a[3]=t=>e.getTableData(!0))},{default:n(()=>[C($(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),F("div",Z,[z((D(),v(g,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=t=>e.page=t),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:n(()=>[o(f,{prop:"Name",label:"\u901A\u9053\u4EA7\u54C1\u540D\u79F0",align:"center"}),o(f,{prop:"RoldRang",label:"\u901A\u9053\u4EA7\u54C1\u7F16\u7801",align:"center"}),o(f,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:n(t=>[o(p,{title:e.$t("message.common.delTip"),onConfirm:ee=>e.handleDel([t.row])},{reference:n(()=>[o(l,{type:"danger"},{default:n(()=>[C($(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[y,e.loading]]),e.layer.show?(D(),v(w,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):T("",!0),e.Layeredit.show?(D(),v(u,{key:1,layer:e.Layeredit,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):T("",!0)])])}var ie=R(K,[["render",x]]);export{ie as default};
